/**
 *
 */
macroscript core_conversation__createConversationByService(
	/** Optionnal room id */ string id,
	/** Conversation room name */ @NotNull string name,
	/** Conversation room members */ @NotNull array members,
	/** Group service */@NotNull service<groups> zpService
) {
	trace(#core_conversation__createConversationByService, { id, name, members, userKey: __userKey });
	/** Generate uniq conversation id */
	id = id ?: usr:core_conversation__id();
	trace(#core_conversation__createConversationByService, id);
	/** Create conversation room */
	const { room } = await core_conversation__createConversationRoomByService({
		id, name, members, zpService
	});
	trace(#core_conversation__createConversationByService, room);
	/** Execute all registered macros */
	zpRecipeUtils::zpServiceTrigger.trigger({
		event: EVENT__CREATE_CONVERSATION,
		data: { room }
	});
} return {
	string container: id,
	Room room
} on channel __selfName
