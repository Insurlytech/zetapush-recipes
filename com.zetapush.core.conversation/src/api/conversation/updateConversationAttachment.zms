macroscript updateConversationAttachment(
		/** the unique identifier of the conversation that contains the message to update */
		@NotNull string id,
		/** the owner of the conversation */
		@NotNull string owner,
		/** the uploaded file (guid) */
		@NotNull string fileGuid,
		/** the generated thumbnails for the uploaded file */
		array thumbnails) {
	
	/** Get message */
	var response = call core_conversation__getConversationMessageByFile({ id, owner, guid: fileGuid }) hardFail;
	var originalMessage = response.result.message;
	var originalData = originalMessage.data;
	var originalMetadata = originalData.metadata;
	/** Merge original metadata with new thumbnails */
	var newMetadata = {
		contentType: originalMetadata.contentType,
		name: originalMetadata.name,
		path: originalMetadata.path,
		size: originalMetadata.size,
		uploadedAt: originalMetadata.uploadedAt,
		thumbnails: thumbnails
	};
	/** Update message information */
	var updatedMessage = call updateConversationMessage({ 
		id, owner, originalMessage, newMetadata
	}) hardFail;
	/** Get the targets for the conversation */
	var { result: { value: targets } } = sudo owner call zpRecipeUtils::getTargets({ id }) hardFail;
} return { id, message: updatedMessage.result, thumbnails, targets }
